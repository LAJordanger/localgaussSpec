This folder contains the code needed for the reproduction of figure F4 in the paper P1="Nonlinear spectral analysis: A local Gaussian approach" (published in the Journal of the American Statistical Association, https://doi.org/10.1080/01621459.2020.1840991, see also https://arxiv.org/abs/1708.02166).

This plot investigates a single sample from the "local trigonometric" example, and creates a plot similar to P1_fig_F3.  The local "2_Data.R"-file is similar to the one in P1_fig_F2, and a trivial modification can be done in the "4_Plot.R"-file in P1_fig_F2 if a similar plot is desired for the present case too.

The purpose of this plot is to investigate how the block length L (from the adjusted block bootstrap given in P1) affects the estimated pointwise confidence intervals, and the idea is that it is better to show that it behaves in the same manner both for the dmbp-data and the "local trigonometric"-example.  Note that the script in "2_Data.R" takes some time to finish.

The file "3_Shiny.R" contains the code that is needed in order to start the interactive shiny-application, which enables the user to see how the resulting local Gaussian spectral densities changes with the different tuning parameters (truncation level, bandwidth, point) that was used in "2_Data.R".

The file "4_Plot.R" contains the code needed for the reproduction of figure F4 in paper P1.  This script will for the specified tuning parameters create the desired plots, adjust them (e.g. having the same scale on all the plots), and then collect the plots in a file that is saved to disk.

NOTE: It is intended that this script can be used as a template for similar investigations.  The interested reader should then be aware of the fact that the code in "2_Data.R" creates a folder with a name that depends on the investigated example, and the name of this folder is needed in the files "3_Shiny.R" and "4_Plot.R".  The present folder-reference in "3_Shiny.R" and "4_Plot.R" is based on the result from "2_Data.R" when it was tested by the developer, and for simulated time series (based on a given seed to the random number generator), it should be the same result that occurs every time the script is used.  It is however not possible to guarantee that the exact same result will occur across different operative systems (or different versions of R), so it might thus happen that some users must perform a minor revision due to this.  This task requires an update of one line of code in the beginning of the respective files.
